Peach=function(){function t(){Peach.Primitive.clear();for(var t=Peach.entities.length,e=0;t>e;e++)Peach.entities[e].draw()}function e(){requestAnimFrame(e),t(),n()}function n(){Peach.gameState.t1=Peach.gameState.t2,Peach.gameState.t2=(new Date).getTime(),Peach.gameState.frameTime=Peach.gameState.t2-Peach.gameState.t1;for(var t=Peach.entities.length,e=t-1;e>=0;e--)Peach.entities[e].update(),Peach.entities[e].alive||Peach.entities.splice(e,1)}return window.requestAnimFrame=function(){for(var t=["requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame"],e=0;5>e;e++)if(void 0!==window[t[e]])return window[t[e]];return function(t){window.setTimeout(t,1e3/60)}}(),{context:null,entities:[],gameState:{},init:function(t){var e=document.getElementById(t);Peach.gameState.width=e.width,Peach.gameState.height=e.height;var n=Peach.Geometry.Point.fromCartesian(0,0),o=Peach.Geometry.Point.fromCartesian(e.width,e.height);Peach.gameState.rectangle=new Peach.Geometry.Rectangle(n,o),Peach.context=e.getContext("2d"),Peach.Input.init()},start:function(){Peach.gameState.t2=(new Date).getTime(),e()}}}(),Peach.Drawable=function(){return{draw:function(){}}}(),Peach.Input=function(){function t(t){var n;window.event?n=window.event.keyCode:t&&(n=e.which),Peach.Input.state.keys[r[n]]=!0}function n(t){var n;window.event?n=window.event.keyCode:t&&(n=e.which),Peach.Input.state.keys[r[n]]=!1}function o(){Peach.Input.state.mouseIsDown=!0}function a(t){Peach.Input.state.mousePosition.x=t.clientX,Peach.Input.state.mousePosition.y=t.clientY}function i(){Peach.Input.state.mouseIsDown=!1}var r={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"caps",27:"esc",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",91:"left_window",92:"right_window",93:"select",96:"0_pad",97:"1_pad",98:"2_pad",99:"3_pad",100:"4_pad",101:"5_pad",102:"6_pad",103:"7_pad",104:"8_pad",105:"9_pad"};return{init:function(){r.length;for(var e in r)Peach.Input.state.keys[r[e]]=!1;window.onkeydown=t,window.onkeyup=n,window.onmousedown=o,window.onmousemove=a,window.onmouseup=i},state:{mouseIsDown:!1,mousePosition:{x:0,y:0},keys:{}}}}(),Peach.Geometry=function(){return{}}(),Peach.Geometry.Point=function(){var t=function(){};return t.fromCartesian=function(e,n){var o=new t;return o.x=e,o.y=n,o},t.fromPolar=function(e,n){var o=new t;return o.x=e*Math.cos(n),o.y=e*Math.sin(n),o},t.prototype.dot=function(t){return this.x*t.x+this.y*t.y},t.prototype.magnitude=function(){return Math.sqrt(this.dot(this))},t.prototype.negate=function(){return t.fromCartesian(-this.x,-this.y)},t.prototype.add=function(e){return t.fromCartesian(this.x+e.x,this.y+e.y)},t.prototype.scale=function(e){return t.fromCartesian(this.x*e,this.y*e)},t.prototype.rotate=function(e){var n=Math.cos(e)*this.x-Math.sin(e)*this.y,o=Math.sin(e)*this.x+Math.sin(e)*this.y;return t.fromCartesian(n,o)},t}(),Peach.Geometry.Rectangle=function(){var t=function(t,e){var n=Math.min(t.x,e.x),o=Math.min(t.y,e.y),a=Math.max(t.x,e.x),i=Math.max(t.y,e.y);this.top_left=Peach.Geometry.Point.fromCartesian(n,o),this.top_right=Peach.Geometry.Point.fromCartesian(a,o),this.bottom_left=Peach.Geometry.Point.fromCartesian(n,i),this.bottom_right=Peach.Geometry.Point.fromCartesian(a,i),this.width=a-n,this.height=i-o};return t.prototype.contains=function(t){return!(this.toRightOf(t)||this.toLeftOf(t)||this.above(t)||this.below(t))},t.prototype.toRightOf=function(t){return this.top_left.x>t.x},t.prototype.toLeftOf=function(t){return this.top_right.x<t.x},t.prototype.above=function(t){return this.bottom_right.y<t.y},t.prototype.below=function(t){return this.top_right.y>t.y},t}(),Peach.Primitive=function(){return{clear:function(){Peach.context.clearRect(0,0,Peach.gameState.width,Peach.gameState.height)},line:function(t,e,n){Peach.context.strokeStyle=n,Peach.context.beginPath(),Peach.context.moveTo(t.x,t.y),Peach.context.lineTo(e.x,e.y),Peach.context.closePath(),Peach.context.stroke()},polygon:function(t,e){var n=t.length;if(0!==n)for(var o=0;n-1>o;o++)Peach.Primitive.line(t[o],t[o+1],e)},rect:function(t,e){Peach.context.fillStyle=e,Peach.context.fillRect(t.top_left.x,t.top_left.y,t.width,t.height)},circle:function(t,e,n){Peach.context.fillStyle=n,Peach.context.beginPath(),Peach.context.arc(t.x-e,t.y-e,e,0,2*Math.PI,!0),Peach.context.closePath(),Peach.context.fill()},image:function(t,e){var n=new Image;n.onload=function(){e instanceof Peach.Geometry.Point?Peach.context.drawImage(n,e.x,e.y):Peach.context.drawImage(n,e.top_left.x,e.top_left.y,e.bottom_right.x,e.bottom_right.y)},n.src=t}}}();